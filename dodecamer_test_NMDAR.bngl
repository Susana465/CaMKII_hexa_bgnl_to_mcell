begin parameters
    D_VOL 1e-6 # cm^2/s
	D_SURF 1e-8 # cm^2/s

    MCELL_DIFFUSION_CONSTANT_3D_CAMKII D_VOL
    MCELL_DIFFUSION_CONSTANT_2D_NMDAR D_SURF
    #MCELL_DIFFUSION_CONSTANT_3D_C D_SURF

    NA_um3 6.022e8 # Avogadro's number mutiplied by 1e-15 since we are using volume units of microns(^-3)
	VOL_RXN 1
	MCELL_REDEFINE_NA_um3 VOL_RXN # In MCell the units get multiplied by V_RXN so they stay the same
    
    kon222 1e8
    koff 1e-1

    kon_CaMKII_NMDAR 3e5/NA_um3 #taken from 2nd_year PhD report
	koff_CaMKII_NMDAR 0.284
    
    ITERATIONS 10e2

    VolCP 0.50588 
    VolPM 0.0307 # from volume of 0.505 r = 0.494 and area = 3.07um2 * 0.01um thickness. Assuming a thickness of 0.01 microns for the PM
end parameters

begin compartments
    PM 2 VolPM #2Dimensions, surface compartment
 	CP 3 VolCP PM #3Dimensions and 1 microcubic in volume, volume compartment
end compartments

begin seed species
    CAMKII(b)@CP 600
    NMDAR(a)@PM 30
    #CAMKII(b!1).NMDAR(a!1)@PM 0
end seed species  

begin observables
    Molecules camkii CAMKII(b)
    Molecules nmdar NMDAR(a)
    Molecules C CAMKII(b!1).NMDAR(a!1)
    #Molecules C C()
end observables

begin reaction rules
    CAMKII(b)@IN + NMDAR(a) -> CAMKII(b!1).NMDAR(a!1) kon_CaMKII_NMDAR
    CAMKII(b!1).NMDAR(a!1) -> CAMKII(b)@IN + NMDAR(a) koff_CaMKII_NMDAR
    #A(b)@IN + B(a) -> C()@IN kon222
end reaction rules  

simulate({method=>"ssa",t_end=>"ITERATIONS",n_steps=>10})