begin parameters
    D_VOL 1e-6 # cm^2/s
	D_SURF 1e-8 # cm^2/s

    MCELL_DIFFUSION_CONSTANT_3D_CaMKII D_VOL
    MCELL_DIFFUSION_CONSTANT_2D_NMDAR D_SURF
    #MCELL_DIFFUSION_CONSTANT_3D_C D_SURF

    NA_um3 6.022e8 # Avogadro's number mutiplied by 1e-15 since we are using volume units of microns(^-3)
	VOL_RXN 1
	MCELL_REDEFINE_NA_um3 VOL_RXN # In MCell the units get multiplied by V_RXN so they stay the same
    
    kon222 1e8
    koff 1e-1

    kon_CaMKII_NMDAR 3e5/NA_um3 #taken from 2nd_year PhD report
	koff_CaMKII_NMDAR 0.284

    ITERATIONS 10e2

    VolCP 0.50588 
    VolPM 0.0307 # from volume of 0.505 r = 0.494 and area = 3.07um2 * 0.01um thickness. Assuming a thickness of 0.01 microns for the PM
end parameters

begin compartments
    PM 2 VolPM #2Dimensions, surface compartment
 	CP 3 VolCP PM #3Dimensions and 1 microcubic in volume, volume compartment
end compartments

begin seed species
    @CP:CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!6,r!1,c!13).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!1,r!2,c!14).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!2,r!3,c!15).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!3,r!4,c!16).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!4,r!5,c!17).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!5,r!6,c!18).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!12,r!7,c!13).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!7,r!8,c!14).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!8,r!9,c!15).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!9,r!10,c!16).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!10,r!11,c!17).CaMKII(cam,nmdar,T286~0,T306~0,open~1,l!11,r!12,c!18) 600
    NMDAR(a)@PM 30
    #CaMKII(b!1).NMDAR(a!1)@PM 0
end seed species  

begin observables
    #Molecules CaMKII CaMKII(b)
    Molecules nmdar NMDAR(a)
    Molecules CaMKII_NMDAR CaMKII(nmdar!1).NMDAR(a!1)
    #Molecules C C()
end observables

begin reaction rules
    CaMKII(nmdar)@IN + NMDAR(a) -> CaMKII(nmdar!1).NMDAR(a!1) kon_CaMKII_NMDAR
    CaMKII(nmdar!1).NMDAR(a!1) -> CaMKII(nmdar)@IN + NMDAR(a) koff_CaMKII_NMDAR
    #A(b)@IN + B(a) -> C()@IN kon222
end reaction rules  

simulate({method=>"ssa",t_end=>"ITERATIONS",n_steps=>10})